<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:EasySave.GUI.ViewModels"
        x:Class="EasySave.GUI.Views.SettingsWindow"
        x:DataType="vm:SettingsViewModel"
        Title="{Binding Localization[Settings]}"
        Width="700" Height="500"
        WindowStartupLocation="CenterOwner"
        CanResize="false">

    <Design.DataContext>
        <vm:SettingsViewModel/>
    </Design.DataContext>

    <Grid Margin="20" RowDefinitions="Auto,*,Auto">
        
        <!-- Settings Content -->
        <ScrollViewer Grid.Row="1">
            <StackPanel Spacing="20">
                
                <!-- Encryption Extensions -->
                <Border BorderBrush="Gray" BorderThickness="1" Padding="15" CornerRadius="5">
                    <StackPanel Spacing="10">
                        <TextBlock Text="{Binding Localization[FileExtensionsToEncrypt]}" 
                                   FontWeight="Bold" 
                                   FontSize="14"/>
                        
                        <Grid ColumnDefinitions="*,Auto,Auto">
                            <TextBox Grid.Column="0" 
                                     Text="{Binding NewExtension}" 
                                     Watermark=".txt, .docx, .pdf..."
                                     Margin="0,0,5,0"/>
                            <Button Grid.Column="1" 
                                    Content="{Binding Localization[Add]}" 
                                    Command="{Binding AddExtensionCommand}"
                                    MinWidth="70"
                                    Padding="10,5"
                                    Margin="0,0,5,0"/>
                            <Button Grid.Column="2" 
                                    Content="{Binding Localization[Remove]}" 
                                    Command="{Binding RemoveExtensionCommand}"
                                    MinWidth="70"
                                    Padding="10,5"/>
                        </Grid>
                        
                        <ListBox ItemsSource="{Binding ExtensionsToEncrypt}"
                                 SelectedItem="{Binding SelectedExtension}"
                                 Height="120"
                                 Background="#F5F5F5"/>
                    </StackPanel>
                </Border>

                <!-- Business Software Detection -->
                <Border BorderBrush="Gray" BorderThickness="1" Padding="15" CornerRadius="5">
                    <StackPanel Spacing="10">
                        <TextBlock Text="{Binding Localization[BusinessSoftwareDetection]}" 
                                   FontWeight="Bold" 
                                   FontSize="14"/>
                        <TextBlock Text="{Binding Localization[ProcessNameToMonitor]}" 
                                   Foreground="Gray"/>
                        <TextBox Text="{Binding BusinessSoftwareName}" 
                                 Watermark="e.g., notepad, excel, word..."/>
                    </StackPanel>
                </Border>

                <!-- CryptoSoft Configuration -->
                <Border BorderBrush="Gray" BorderThickness="1" Padding="15" CornerRadius="5">
                    <StackPanel Spacing="10">
                        <TextBlock Text="{Binding Localization[CryptoSoftEncryptionTool]}" 
                                   FontWeight="Bold" 
                                   FontSize="14"/>
                        <TextBlock Text="{Binding Localization[PathToCryptoSoft]}" 
                                   Foreground="Gray"/>
                        <Grid ColumnDefinitions="*,Auto">
                            <TextBox Grid.Column="0" 
                                     Text="{Binding CryptoSoftPath}" 
                                     Watermark="C:\Path\To\CryptoSoft.exe"/>
                            <Button Grid.Column="1" 
                                    Content="{Binding Localization[Browse]}" 
                                    Command="{Binding BrowseCryptoSoftCommand}"
                                    Margin="5,0,0,0"
                                    MinWidth="80"
                                    Padding="10,5"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Large File Threshold -->
                <Border BorderBrush="Gray" BorderThickness="1" Padding="15" CornerRadius="5">
                    <StackPanel Spacing="10">
                        <TextBlock Text="{Binding Localization[LargeFileThreshold]}" 
                                   FontWeight="Bold" 
                                   FontSize="14"/>
                        <TextBlock Text="{Binding Localization[MaxFileSizeForParallel]}" 
                                   Foreground="Gray"
                                   TextWrapping="Wrap"/>
                        <NumericUpDown Value="{Binding MaxLargeFileSize}" 
                                       Minimum="0"
                                       Maximum="9999999999"
                                       Increment="1048576"
                                       FormatString="N0"/>
                    </StackPanel>
                </Border>

                <!-- Log Format -->
                <Border BorderBrush="Gray" BorderThickness="1" Padding="15" CornerRadius="5">
                    <StackPanel Spacing="10">
                        <TextBlock Text="{Binding Localization[LogFormat]}" 
                                   FontWeight="Bold" 
                                   FontSize="14"/>
                        <ComboBox ItemsSource="{Binding LogFormats}"
                                  SelectedItem="{Binding SelectedLogFormat}"
                                  HorizontalAlignment="Stretch"/>
                    </StackPanel>
                </Border>

            </StackPanel>
        </ScrollViewer>

        <!-- Buttons -->
        <StackPanel Grid.Row="2" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right" 
                    Spacing="10"
                    Margin="0,20,0,0">
            <Button Content="{Binding Localization[Save]}" 
                    Command="{Binding SaveCommand}"
                    MinWidth="100"
                    Padding="15,5"
                    IsDefault="True"/>
            <Button Content="{Binding Localization[Cancel]}" 
                    Command="{Binding CancelCommand}"
                    MinWidth="100"
                    Padding="15,5"/>
        </StackPanel>
    </Grid>
</Window>
